"use client";
import React, { useState } from "react";
import { Portal } from "./Portal";

interface Pickup {
    customer: string;
    driverID: string;
    totes: string;
}

interface Styles {
    container: React.CSSProperties;
    header: React.CSSProperties;
    label: React.CSSProperties;
    inputRow: React.CSSProperties;
    input: React.CSSProperties;
    button: React.CSSProperties;
    link: React.CSSProperties;
}

const styles: Styles = {
    container: {
        backgroundColor: "#FFFFFF",
        padding: "30px",
        borderRadius: "20px",
        fontFamily: "'Inter', sans-serif",
        width: "100%",
        boxShadow: "0 4px 10px rgba(0, 0, 0, 0.1)",
        maxHeight: "100%",
        display: "flex",
        flexDirection: "column"
    },
    header: {
        fontSize: "1.75rem",
        fontWeight: 700,
        marginBottom: "20px",
    },
    label: {
        fontWeight: 600,
        marginBottom: "8px",
        display: "block",
    },
    inputRow: {
        display: "flex",
        gap: "15px",
        marginTop: "20px",
    },
    input: {
        flex: 1,
        padding: "10px",
        fontSize: "16px",
        borderRadius: "8px",
        border: "1px solid #ccc",
        width: "100%",
    },
    button: {
        marginTop: "30px",
        width: "100%",
        padding: "12px",
        backgroundColor: "#0066CC",
        color: "white",
        fontSize: "18px",
        fontWeight: 600,
        border: "none",
        borderRadius: "12px",
        cursor: "pointer",
    },
    link: {
        textAlign: "center",
        display: "block",
        margin: "20px auto 0 auto",
        color: "#0066CC",
        fontWeight: 500,
        cursor: "pointer",
    },
};

export default function AddPickup() {
    const [date, setDate] = useState("");
    const [pickups, setPickups] = useState<Pickup[]>([
        { customer: "", driverID: "", totes: "" }
    ]);

    const handleChange = (index: number, field: keyof Pickup, value: string) => {
        const newPickups = [...pickups];
        newPickups[index][field] = value;
        setPickups(newPickups);
    };

    const handleAddPickup = () => {
        setPickups([...pickups, { customer: "", driverID: "", totes: "" }]);
    };

    // TODO: handle how you want to connect this to backend, for now just console logs
    const handleSubmit = () => {
        console.log("Submitted pickups:", pickups);
    };

    return (
        <div style={styles.container}>
            <h2 style={styles.header}>Add pickup</h2>

            <label style={styles.label}>Date</label>
            <input
                type="date"
                value={date}
                onChange={(e) => setDate(e.target.value)}
                style={{ ...styles.input, width: "100%" }}
            />

            <div className="overflow-y-auto">
                {pickups.map((pickup, index) => (
                    <div key={index}>
                        <div style={styles.inputRow}>
                            <div style={{ flex: 1 }}>
                                <label style={styles.label} htmlFor={`customer-${index}`}>
                                    Customer
                                </label>
                                <input
                                    id={`customer-${index}`}
                                    type="text"
                                    value={pickup.customer}
                                    onChange={(e) =>
                                        handleChange(index, "customer", e.target.value)
                                    }
                                    style={styles.input}
                                />
                            </div>

                            <div style={{ flex: 1 }}>
                                <label style={styles.label}>Driver ID</label>
                                <input
                                    type="text"
                                    value={pickup.driverID}
                                    onChange={(e) =>
                                        handleChange(index, "driverID", e.target.value)
                                    }
                                    style={styles.input}
                                />
                            </div>

                            <div style={{ flex: 1 }}>
                                <label style={styles.label}>Number of totes</label>
                                <input
                                    type="number"
                                    value={pickup.totes}
                                    onChange={(e) => handleChange(index, "totes", e.target.value)}
                                    style={styles.input}
                                />
                            </div>
                        </div>
                    </div>
                ))}
            </div>

            <button style={styles.button} onClick={handleSubmit}>
                Save
            </button>

            <button style={styles.link} onClick={handleAddPickup}>
                Add multiple pickups
            </button>
        </div>
    );
}

export function AddPickupButton({ isCollapsed }: { isCollapsed: boolean }) {
    const [modalVisible, setModalVisible] = useState<boolean>(true);

    return (
        <>
            <button
                className={`group h-[51px] flex items-center justify-center ${isCollapsed ? "w-[64px]" : "w-[210px]"
                    }`}
                onClick={() => setModalVisible(true)}
            >
                <div>
                    {isCollapsed ? (
                        <svg
                            width="64"
                            height="51"
                            viewBox="0 0 64 51"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <rect
                                width="64"
                                height="51"
                                rx="20"
                                className="fill-white group-hover:fill-[#E6E6E6]"
                            />
                            <path
                                d="M28 25.5H32M32 25.5H36M32 25.5V29.5M32 25.5V21.5M32 34.5C27.0294 34.5 23 30.4706 23 25.5C23 20.5294 27.0294 16.5 32 16.5C36.9706 16.5 41 20.5294 41 25.5C41 30.4706 36.9706 34.5 32 34.5Z"
                                stroke="black"
                                strokeWidth="2"
                                strokeLinecap="round"
                                strokeLinejoin="round"
                            />
                        </svg>
                    ) : (
                        <svg
                            width="210"
                            height="51"
                            viewBox="0 0 210 51"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <rect
                                width="210"
                                height="51"
                                rx="20"
                                className="fill-white group-hover:fill-[#E6E6E6]"
                            />
                            <path
                                d="M28 25.5H32M32 25.5H36M32 25.5V29.5M32 25.5V21.5M32 34.5C27.0294 34.5 23 30.4706 23 25.5C23 20.5294 27.0294 16.5 32 16.5C36.9706 16.5 41 20.5294 41 25.5C41 30.4706 36.9706 34.5 32 34.5Z"
                                stroke="#464646"
                                strokeWidth="2"
                                strokeLinecap="round"
                                strokeLinejoin="round"
                            />
                            <path
                                d="M56.9723 32.5H54.4411L59.0497 19.4091H61.9773L66.5923 32.5H64.0611L60.5646 22.0938H60.4624L56.9723 32.5ZM57.0554 27.3672H63.9588V29.272H57.0554V27.3672ZM71.5589 32.6726C70.7876 32.6726 70.0973 32.4744 69.4879 32.0781C68.8786 31.6818 68.397 31.1065 68.0433 30.3523C67.6896 29.598 67.5128 28.6818 67.5128 27.6037C67.5128 26.5128 67.6918 25.5923 68.0497 24.8423C68.4119 24.0881 68.8999 23.5192 69.5135 23.1357C70.1271 22.7479 70.8111 22.554 71.5653 22.554C72.1406 22.554 72.6136 22.652 72.9844 22.848C73.3551 23.0398 73.6491 23.272 73.8665 23.5447C74.0838 23.8132 74.2521 24.0668 74.3714 24.3054H74.4673V19.4091H76.7876V32.5H74.5121V30.9531H74.3714C74.2521 31.1918 74.0795 31.4453 73.8537 31.7138C73.6278 31.978 73.3295 32.2038 72.9588 32.3913C72.5881 32.5788 72.1214 32.6726 71.5589 32.6726ZM72.2045 30.7741C72.6946 30.7741 73.1122 30.642 73.4574 30.3778C73.8026 30.1094 74.0646 29.7365 74.2436 29.2592C74.4226 28.782 74.5121 28.2259 74.5121 27.5909C74.5121 26.956 74.4226 26.4041 74.2436 25.9354C74.0689 25.4666 73.8089 25.1023 73.4638 24.8423C73.1229 24.5824 72.7031 24.4524 72.2045 24.4524C71.6889 24.4524 71.2585 24.5866 70.9134 24.8551C70.5682 25.1236 70.3082 25.4943 70.1335 25.9673C69.9588 26.4403 69.8714 26.9815 69.8714 27.5909C69.8714 28.2045 69.9588 28.7521 70.1335 29.2337C70.3125 29.7109 70.5746 30.0881 70.9197 30.3651C71.2692 30.6378 71.6974 30.7741 72.2045 30.7741ZM82.8968 32.6726C82.1255 32.6726 81.4352 32.4744 80.8258 32.0781C80.2164 31.6818 79.7349 31.1065 79.3812 30.3523C79.0275 29.598 78.8507 28.6818 78.8507 27.6037C78.8507 26.5128 79.0297 25.5923 79.3876 24.8423C79.7498 24.0881 80.2377 23.5192 80.8514 23.1357C81.465 22.7479 82.149 22.554 82.9032 22.554C83.4785 22.554 83.9515 22.652 84.3223 22.848C84.693 23.0398 84.987 23.272 85.2044 23.5447C85.4217 23.8132 85.59 24.0668 85.7093 24.3054H85.8052V19.4091H88.1255V32.5H85.85V30.9531H85.7093C85.59 31.1918 85.4174 31.4453 85.1916 31.7138C84.9657 31.978 84.6674 32.2038 84.2967 32.3913C83.926 32.5788 83.4593 32.6726 82.8968 32.6726ZM83.5424 30.7741C84.0325 30.7741 84.4501 30.642 84.7953 30.3778C85.1404 30.1094 85.4025 29.7365 85.5815 29.2592C85.7605 28.782 85.85 28.2259 85.85 27.5909C85.85 26.956 85.7605 26.4041 85.5815 25.9354C85.4068 25.4666 85.1468 25.1023 84.8017 24.8423C84.4608 24.5824 84.041 24.4524 83.5424 24.4524C83.0268 24.4524 82.5964 24.5866 82.2512 24.8551C81.9061 25.1236 81.6461 25.4943 81.4714 25.9673C81.2967 26.4403 81.2093 26.9815 81.2093 27.5909C81.2093 28.2045 81.2967 28.7521 81.4714 29.2337C81.6504 29.7109 81.9125 30.0881 82.2576 30.3651C82.6071 30.6378 83.0353 30.7741 83.5424 30.7741ZM95.0561 36.1818V22.6818H97.3317V24.3054H97.4659C97.5852 24.0668 97.7536 23.8132 97.9709 23.5447C98.1882 23.272 98.4822 23.0398 98.853 22.848C99.2237 22.652 99.6967 22.554 100.272 22.554C101.031 22.554 101.714 22.7479 102.324 23.1357C102.938 23.5192 103.423 24.0881 103.781 24.8423C104.143 25.5923 104.325 26.5128 104.325 27.6037C104.325 28.6818 104.148 29.598 103.794 30.3523C103.44 31.1065 102.959 31.6818 102.349 32.0781C101.74 32.4744 101.05 32.6726 100.278 32.6726C99.7159 32.6726 99.2493 32.5788 98.8786 32.3913C98.5078 32.2038 98.2095 31.978 97.9837 31.7138C97.7621 31.4453 97.5895 31.1918 97.4659 30.9531H97.37V36.1818H95.0561ZM97.3253 27.5909C97.3253 28.2259 97.4148 28.782 97.5938 29.2592C97.777 29.7365 98.0391 30.1094 98.38 30.3778C98.7251 30.642 99.1428 30.7741 99.6328 30.7741C100.144 30.7741 100.572 30.6378 100.918 30.3651C101.263 30.0881 101.523 29.7109 101.697 29.2337C101.876 28.7521 101.966 28.2045 101.966 27.5909C101.966 26.9815 101.879 26.4403 101.704 25.9673C101.529 25.4943 101.269 25.1236 100.924 24.8551C100.579 24.5866 100.148 24.4524 99.6328 24.4524C99.1385 24.4524 98.7188 24.5824 98.3736 24.8423C98.0284 25.1023 97.7663 25.4666 97.5874 25.9354C97.4126 26.4041 97.3253 26.956 97.3253 27.5909ZM106.306 32.5V22.6818H108.62V32.5H106.306ZM107.469 21.2884C107.103 21.2884 106.788 21.1669 106.523 20.924C106.259 20.6768 106.127 20.3807 106.127 20.0355C106.127 19.6861 106.259 19.3899 106.523 19.147C106.788 18.8999 107.103 18.7763 107.469 18.7763C107.84 18.7763 108.156 18.8999 108.415 19.147C108.68 19.3899 108.812 19.6861 108.812 20.0355C108.812 20.3807 108.68 20.6768 108.415 20.924C108.156 21.1669 107.84 21.2884 107.469 21.2884ZM115.282 32.6918C114.302 32.6918 113.46 32.4766 112.757 32.0462C112.058 31.6158 111.519 31.0213 111.14 30.2628C110.765 29.5 110.578 28.6222 110.578 27.6293C110.578 26.6321 110.769 25.7521 111.153 24.9893C111.536 24.2223 112.078 23.6257 112.776 23.1996C113.48 22.7692 114.311 22.554 115.269 22.554C116.066 22.554 116.771 22.701 117.385 22.995C118.003 23.2848 118.495 23.696 118.862 24.2287C119.228 24.7571 119.437 25.375 119.488 26.0824H117.276C117.187 25.6094 116.974 25.2152 116.637 24.8999C116.305 24.5803 115.86 24.4205 115.301 24.4205C114.828 24.4205 114.413 24.5483 114.055 24.804C113.697 25.0554 113.418 25.4176 113.218 25.8906C113.021 26.3636 112.923 26.9304 112.923 27.5909C112.923 28.2599 113.021 28.8352 113.218 29.3168C113.414 29.794 113.688 30.1626 114.042 30.4226C114.4 30.6783 114.82 30.8061 115.301 30.8061C115.642 30.8061 115.947 30.7422 116.215 30.6143C116.488 30.4822 116.716 30.2926 116.899 30.0455C117.083 29.7983 117.208 29.4979 117.276 29.1442H119.488C119.433 29.8388 119.228 30.4545 118.874 30.9915C118.521 31.5241 118.039 31.9418 117.43 32.2443C116.82 32.5426 116.105 32.6918 115.282 32.6918ZM123.498 29.419L123.491 26.6257H123.862L127.39 22.6818H130.094L125.754 27.5142H125.275L123.498 29.419ZM121.388 32.5V19.4091H123.702V32.5H121.388ZM127.55 32.5L124.354 28.032L125.914 26.402L130.318 32.5H127.55ZM137.894 28.3707V22.6818H140.208V32.5H137.964V30.755H137.862C137.64 31.3047 137.276 31.7543 136.769 32.1037C136.266 32.4531 135.646 32.6278 134.909 32.6278C134.265 32.6278 133.697 32.4851 133.202 32.1996C132.712 31.9098 132.329 31.4901 132.052 30.9403C131.775 30.3864 131.636 29.7173 131.636 28.9332V22.6818H133.95V28.5753C133.95 29.1974 134.121 29.6918 134.461 30.0582C134.802 30.4247 135.25 30.608 135.804 30.608C136.145 30.608 136.475 30.5249 136.795 30.3587C137.114 30.1925 137.376 29.9453 137.581 29.6172C137.79 29.2848 137.894 28.8693 137.894 28.3707ZM142.587 36.1818V22.6818H144.863V24.3054H144.997C145.116 24.0668 145.285 23.8132 145.502 23.5447C145.719 23.272 146.013 23.0398 146.384 22.848C146.755 22.652 147.228 22.554 147.803 22.554C148.562 22.554 149.246 22.7479 149.855 23.1357C150.469 23.5192 150.955 24.0881 151.312 24.8423C151.675 25.5923 151.856 26.5128 151.856 27.6037C151.856 28.6818 151.679 29.598 151.325 30.3523C150.972 31.1065 150.49 31.6818 149.881 32.0781C149.271 32.4744 148.581 32.6726 147.81 32.6726C147.247 32.6726 146.781 32.5788 146.41 32.3913C146.039 32.2038 145.741 31.978 145.515 31.7138C145.293 31.4453 145.121 31.1918 144.997 30.9531H144.901V36.1818H142.587ZM144.857 27.5909C144.857 28.2259 144.946 28.782 145.125 29.2592C145.308 29.7365 145.57 30.1094 145.911 30.3778C145.256 30.642 146.674 30.7741 147.164 30.7741C147.675 30.7741 148.104 30.6378 148.449 30.3651C148.794 30.0881 149.054 29.7109 149.229 29.2337C149.408 28.7521 149.497 28.2045 149.497 27.5909C149.497 26.9815 149.41 26.4403 149.235 25.9673C149.06 25.4943 148.8 25.1236 148.455 24.8551C148.11 24.5866 147.68 24.4524 147.164 24.4524C146.67 24.4524 146.25 24.5824 145.905 24.8423C145.56 25.1023 145.298 25.4666 145.119 25.9354C144.944 26.4041 144.857 26.956 144.857 27.5909Z"
                                fill="#464646"
                            />
                        </svg>
                    )}
                </div>
            </button>
            <Portal>
                {modalVisible && (
                    <div className="fixed top-0 z-20 p-8 left-0 right-0 bottom-0 flex items-center justify-center bg-black/50">
                        <div className="relative max-h-full flex items-stretch">
                            <AddPickup />
                            <button className="absolute top-8 right-8" onClick={() => setModalVisible(false)}>
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M18 18L12 12M12 12L6 6M12 12L18 6M12 12L6 18" stroke="black" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" />
                                </svg>
                            </button>
                        </div>
                    </div>
                )}
            </Portal>
        </>
    );
}
